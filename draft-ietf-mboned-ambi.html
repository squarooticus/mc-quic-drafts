<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Asymmetric Manifest Based Integrity</title>
<meta content="Jake Holland" name="author">
<meta content="Kyle Rose" name="author">
<meta content="
       This document defines Asymmetric Manifest-Based Integrity (AMBI).
AMBI allows each receiver or forwarder of a stream of multicast packets to check the integrity of the contents of each packet in the data stream.
AMBI operates by passing cryptographically verifiable hashes of the data packets inside manifest messages, and sending the manifests over authenticated out-of-band communication channels. 
    " name="description">
<meta content="xml2rfc 3.24.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-mboned-ambi-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.24.0
    Python 3.12.7
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.4
    lxml 5.3.0
    platformdirs 4.3.6
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.32.3
    setuptools 70.3.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-mboned-ambi.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
  }
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">AMBI</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Holland &amp; Rose</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Mboned</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-mboned-ambi-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Holland</div>
<div class="org">Akamai Technologies, Inc.</div>
</div>
<div class="author">
      <div class="author-name">K. Rose</div>
<div class="org">Akamai Technologies, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Asymmetric Manifest Based Integrity</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines Asymmetric Manifest-Based Integrity (AMBI).
AMBI allows each receiver or forwarder of a stream of multicast packets to check the integrity of the contents of each packet in the data stream.
AMBI operates by passing cryptographically verifiable hashes of the data packets inside manifest messages, and sending the manifests over authenticated out-of-band communication channels.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
    MBONE Deployment Working Group mailing list (mboned@ietf.org),
    which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/mboned/">https://mailarchive.ietf.org/arch/browse/mboned/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
    <span><a href="https://github.com/squarooticus/mc-quic-drafts">https://github.com/squarooticus/mc-quic-drafts</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-comparison-with-tesla" class="internal xref">Comparison with TESLA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="auto internal xref">1.2</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="auto internal xref">1.3</a>.  <a href="#name-notes-for-contributors-and-" class="internal xref">Notes for Contributors and Reviewers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.1">
                    <p id="section-toc.1-1.1.2.3.2.1.1" class="keepWithNext"><a href="#section-1.3.1" class="auto internal xref">1.3.1</a>.  <a href="#name-venues-for-contribution-and" class="internal xref">Venues for Contribution and Discussion</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3.2.2">
                    <p id="section-toc.1-1.1.2.3.2.2.1"><a href="#section-1.3.2" class="auto internal xref">1.3.2</a>.  <a href="#name-non-obvious-doc-choices" class="internal xref">Non-obvious doc choices</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-threat-model" class="internal xref">Threat Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="auto internal xref">2.1</a>.  <a href="#name-security-anchors" class="internal xref">Security Anchors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1.2.1">
                    <p id="section-toc.1-1.2.2.1.2.1.1"><a href="#section-2.1.1" class="auto internal xref">2.1.1</a>.  <a href="#name-alternatives-and-their-requ" class="internal xref">Alternatives and Their Requirements</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="auto internal xref">2.2</a>.  <a href="#name-system-security" class="internal xref">System Security</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-protocol-operation" class="internal xref">Protocol Operation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-overview" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-buffering-of-packets-and-di" class="internal xref">Buffering of Packets and Digests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-validation-windows" class="internal xref">Validation Windows</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-preserving-inter-packet-gap" class="internal xref">Preserving Inter-packet Gap</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-packet-digests" class="internal xref">Packet Digests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-digest-profile" class="internal xref">Digest Profile</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-pseudoheader" class="internal xref">Pseudoheader</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-manifests" class="internal xref">Manifests</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="auto internal xref">3.4.1</a>.  <a href="#name-manifest-layout" class="internal xref">Manifest Layout</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="auto internal xref">3.5</a>.  <a href="#name-transitioning-to-other-mani" class="internal xref">Transitioning to Other Manifest Streams</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-transport-considerations" class="internal xref">Transport Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-overview-2" class="internal xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="auto internal xref">4.2</a>.  <a href="#name-https" class="internal xref">HTTPS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="auto internal xref">4.3</a>.  <a href="#name-tls" class="internal xref">TLS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="auto internal xref">4.4</a>.  <a href="#name-dtls" class="internal xref">DTLS</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-examples" class="internal xref">Examples</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-yang-module" class="internal xref">YANG Module</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-tree-diagram" class="internal xref">Tree Diagram</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-module" class="internal xref">Module</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="auto internal xref">7.1</a>.  <a href="#name-the-yang-module-names-regis" class="internal xref">The YANG Module Names Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="auto internal xref">7.2</a>.  <a href="#name-the-xml-registry" class="internal xref">The XML Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="auto internal xref">7.3</a>.  <a href="#name-media-type" class="internal xref">Media Type</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="auto internal xref">7.4</a>.  <a href="#name-uri-schemes" class="internal xref">URI Schemes</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="auto internal xref">7.4.1</a>.  <a href="#name-tls-2" class="internal xref">TLS</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="auto internal xref">7.4.2</a>.  <a href="#name-dtls-2" class="internal xref">DTLS</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-predictable-packets" class="internal xref">Predictable Packets</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-attacks-on-side-application" class="internal xref">Attacks on Side Applications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-acknowledgements" class="internal xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="problems">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Multicast transport poses security problems that are not easily addressed by the same security mechanisms used for unicast transport.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The "Introduction" sections of the documents describing TESLA <span>[<a href="#RFC4082" class="cite xref">RFC4082</a>]</span>, and TESLA in SRTP <span>[<a href="#RFC4383" class="cite xref">RFC4383</a>]</span>, and TESLA with ALC and NORM <span>[<a href="#RFC5776" class="cite xref">RFC5776</a>]</span> present excellent overviews of the challenges unique to multicast authentication for use cases like wide scale software or video distribution with a high data transfer rate. The challenges are briefly summarized here:<a href="#section-1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-3.1">
          <p id="section-1-3.1.1">A MAC based on a symmetric shared secret cannot be used because each packet has multiple receivers that do not trust each other, and using a symmetric shared secret exposes the same secret to each receiver.<a href="#section-1-3.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.2">
          <p id="section-1-3.2.1">Asymmetric per-packet signatures can handle only very low bit-rates because of the transport and computational overhead associated with signature transmission and verification.<a href="#section-1-3.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-1-3.3">
          <p id="section-1-3.3.1">An asymmetric signature of a larger message comprising multiple packets requires reliable receipt of all such packets, something that cannot be guaranteed in a timely manner even for protocols that do provide reliable delivery, and the retransmission of which may anyway exceed the useful lifetime for data formats that can otherwise tolerate some degree of loss.<a href="#section-1-3.3.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-1-4">Aymmetric Manifest-Based Integrity (AMBI) defines a method for receivers or middle boxes to cryptographically authenticate and verify the integrity of a stream of packets by comparing the data packets to a stream of packet "manifests" (described in <a href="#ref-manifest" class="auto internal xref">Section 3.4</a>) received via an out-of-band communication channel that provides authentication and verifiable integrity.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Each manifest contains a message digest (described in <a href="#ref-digests" class="auto internal xref">Section 3.3</a>) for each packet in a sequence of packets from the data stream, hereafter called a "packet digest".
The packet digest incorporates a cryptographic hash of the packet contents and some identifying data from the packet, according to a defined digest profile for the data stream.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Upon receipt of a packet digest inside a manifest conveyed in a secure channel and verification that the packet digest of a received data packet matches, the receiver has proof of the integrity of the contents of the data packet corresponding to that digest.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document defines the "ietf-ambi" YANG <span>[<a href="#RFC7950" class="cite xref">RFC7950</a>]</span> model in <a href="#ref-yang" class="auto internal xref">Section 6</a> as an extension of the "ietf-dorms" model defined in <span>[<a href="#I-D.draft-ietf-mboned-dorms" class="cite xref">I-D.draft-ietf-mboned-dorms</a>]</span>.
Also defined are new URI schemes for transport of manifests over TLS or DTLS, and a new media type for transport of manifests over HTTPS.
The encodings for these are defined in <a href="#ref-transport" class="auto internal xref">Section 4</a>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="comparison-with-tesla">
<section id="section-1.1">
        <h3 id="name-comparison-with-tesla">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-comparison-with-tesla" class="section-name selfRef">Comparison with TESLA</a>
        </h3>
<p id="section-1.1-1">AMBI and TESLA <span>[<a href="#RFC4082" class="cite xref">RFC4082</a>]</span> and <span>[<a href="#RFC5776" class="cite xref">RFC5776</a>]</span> attempt to achieve a similar goal of authenticating the integrity of streams of multicast packets.
AMBI imposes a higher overhead than TESLA imposes, as measured in the amount of extra data required.
In exchange, AMBI relaxes the requirement for establishing an upper bound on clock synchronization between sender and receiver, and allows for the use case of authenticating multicast traffic before forwarding it through the network, while also allowing receivers to authenticate the same traffic.
By contrast, this is not possible with TESLA because the data packets can't be authenticated until a key is disclosed, so either the middlebox has to forward data packets without first authenticating them so that the receiver has them prior to key disclosure, or the middlebox has to hold packets until the key is disclosed, at which point the receiver can no longer establish their authenticity.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The other new capability is that because AMBI provides authentication information out of band, authentication can be retrofitted into some pre-existing deployments without changing the protocol of the data packets under some restrictions outlined in <a href="#ref-security" class="auto internal xref">Section 8</a>.
By contrast, TESLA requires a MAC to be added to each authenticated message.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.2">
        <h3 id="name-terminology">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> and <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notes-for-contributors-and-reviewers">
<section id="section-1.3">
        <h3 id="name-notes-for-contributors-and-">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-notes-for-contributors-and-" class="section-name selfRef">Notes for Contributors and Reviewers</a>
        </h3>
<p id="section-1.3-1">Note to RFC Editor: Please remove this section and its subsections before publication.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">This section is to provide references to make it easier to review the development and discussion on the draft so far.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<div id="venue">
<section id="section-1.3.1">
          <h4 id="name-venues-for-contribution-and">
<a href="#section-1.3.1" class="section-number selfRef">1.3.1. </a><a href="#name-venues-for-contribution-and" class="section-name selfRef">Venues for Contribution and Discussion</a>
          </h4>
<p id="section-1.3.1-1">This document is in the Github repository at:<a href="#section-1.3.1-1" class="pilcrow">¶</a></p>
<p id="section-1.3.1-2"><a href="https://github.com/GrumpyOldTroll/ietf-dorms-cluster">https://github.com/GrumpyOldTroll/ietf-dorms-cluster</a><a href="#section-1.3.1-2" class="pilcrow">¶</a></p>
<p id="section-1.3.1-3">Readers are welcome to open issues and send pull requests for this document.<a href="#section-1.3.1-3" class="pilcrow">¶</a></p>
<p id="section-1.3.1-4">Please note that contributions may be merged and substantially edited, and as a reminder, please carefully consider the Note Well before contributing: <a href="https://datatracker.ietf.org/submit/note-well/">https://datatracker.ietf.org/submit/note-well/</a><a href="#section-1.3.1-4" class="pilcrow">¶</a></p>
<p id="section-1.3.1-5">Substantial discussion of this document should take place on the MBONED working group mailing list (mboned@ietf.org).<a href="#section-1.3.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3.1-6.1">
              <p id="section-1.3.1-6.1.1">Join: <a href="https://www.ietf.org/mailman/listinfo/mboned">https://www.ietf.org/mailman/listinfo/mboned</a><a href="#section-1.3.1-6.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.1-6.2">
              <p id="section-1.3.1-6.2.1">Search: <a href="https://mailarchive.ietf.org/arch/browse/mboned/">https://mailarchive.ietf.org/arch/browse/mboned/</a><a href="#section-1.3.1-6.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
<div id="non-obvious-doc-choices">
<section id="section-1.3.2">
          <h4 id="name-non-obvious-doc-choices">
<a href="#section-1.3.2" class="section-number selfRef">1.3.2. </a><a href="#name-non-obvious-doc-choices" class="section-name selfRef">Non-obvious doc choices</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-1.3.2-1.1">
              <p id="section-1.3.2-1.1.1">TBD: we need a way to assert that we provide the full set of packets for an (S,G) on all UDP ports and non-UDP protocols. Naively authenticating UDP  for specified ports and ignoring other ports means that an attacker could attack a separate UDP port by injecting traffic directed at it, potentially hitting a different application that listens on 0.0.0.0, so an (S,G) with legitimately authenticated UDP traffic on one port could be used to transport UDP-based attacks to apps on another port or protocol unless they are firewalled.  Passing traffic for an (S,G) subscription would open a new channel to such targets that otherwise would not be reachable from the internet for users behind e.g. a CPE with nat or connection-state-based firewalling.<a href="#section-1.3.2-1.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-1.3.2-1.2">
              <p id="section-1.3.2-1.2.1">Dropped intent to support DTLS+FECFRAME in this spec because RFC 6363 seems incomprehensible on a few points, most notably demux strategy between repair and source ADUs, which as written seems to require specifying another layer.  So support for this will have to be a later separate RFC.  However, for future extensibility made manifest-stream into a list instead of a leaf-list so that it can be an augment target for a later YANG extension with FEC selection from the likewise-very-confusing semi-overlapping registries at <a href="https://www.iana.org/assignments/rmt-fec-parameters/rmt-fec-parameters.xhtml">https://www.iana.org/assignments/rmt-fec-parameters/rmt-fec-parameters.xhtml</a> defined by RFCs 5052 and 6363. See also RFC 6363, RFC 6681, and RFC 6865<a href="#section-1.3.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="threat-model">
<section id="section-2">
      <h2 id="name-threat-model">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-threat-model" class="section-name selfRef">Threat Model</a>
      </h2>
<p id="section-2-1">AMBI is designed to operate over the internet, under the Internet Threat Model described in <span>[<a href="#RFC3552" class="cite xref">RFC3552</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">AMBI aims to provide Data Integrity for a multicast data stream, building on the security anchors described in <a href="#anchors" class="auto internal xref">Section 2.1</a> to do so.
The aim is to enable receivers to subscribe to and receive multicast packets from a trusted sender without damage to the Systems Security (Section 2.3 of <span>[<a href="#RFC3552" class="cite xref">RFC3552</a>]</span>) for those receivers or other entities.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Thus, we assume there might be attackers on-path or off-path with the capability to inject or modify packets, but that the attackers have not compromised the sender or discovered any of the sender's secret keys.
We assume that an attacker may have compromised some receivers of the multicast traffic, but still aim to provide the above security properties for receivers that have not been compromised.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Those sending multicast traffic to receivers that include untrusted receivers should avoid transmitting sensitive information that requires strong confidentiality guarantees, due to the risk of compromise from those receivers.
Since multicast transmits the same packets to potentially many receivers, in the presence of potentially compromised receivers confidentiality of the content cannot be assured.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">However, any protocol that provides encryption of the packet data before generating the packet digest can provide confidentiality against on-path passive observers who do not possess the decryption key.
This level of confidentiality can be provided by any such protocols without impact on AMBI's operation.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="anchors">
<section id="section-2.1">
        <h3 id="name-security-anchors">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-security-anchors" class="section-name selfRef">Security Anchors</a>
        </h3>
<p id="section-2.1-1">Establishing the desired security properties for the multicast data packets relies on secure delivery of some other information:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.1">
            <p id="section-2.1-2.1.1">Secured unicast connections (providing Data Integrity) to one or more trusted DORMS <span>[<a href="#I-D.draft-ietf-mboned-dorms" class="cite xref">I-D.draft-ietf-mboned-dorms</a>]</span> servers that use the AMBI extensions to the DORMS YANG model as defined in <a href="#ref-yang" class="auto internal xref">Section 6</a><a href="#section-2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">Secure delivery (providing Data Integrity) of a stream of manifests (<a href="#ref-manifest" class="auto internal xref">Section 3.4</a>)<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-3">The secured unicast connection to the DORMS server provides the Peer Entity authentication of the DORMS server that's needed to establish the Data Integrity of the data it sends.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Note that DORMS provides a method for using DNS to bootstrap discovery of the DORMS server.
In contexts where secure DNS lookup cannot be provided, it's still possible to establish a secure connection to a trusted DORMS server as long as the trusted DORMS server's hostname is known to the receivers (removing the need to use DNS for that discovery).
Once the server name is known, the ordinary certificate verification of that hostname while establishing a secure https connection provides the needed security properties to anchor the rest.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Receiving unauthenticated data packets and knowing how to generate packet digests from the manifest profile provided by the AMBI extensions in the DORMS metadata allows the receiver to generate packet digests based on the contents of the received packet, which can be compared against the packet digests that were securely received.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Comparing the digests and finding the same answer then provides Data Integrity for the data packets that relies on one more property of the digest generation algorithm:<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-7.1">
            <p id="section-2.1-7.1.1">the difficulty of generating a collision for the packet digests contained in the manifest.<a href="#section-2.1-7.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-2.1-8">Taken together, successful validation of the multicast data packets proves within the above constraints that someone with control of the manifest URI streams provided by the DORMS server has verified the sending of the packets corresponding to the digests sent in that stream of manifests.<a href="#section-2.1-8" class="pilcrow">¶</a></p>
<div id="alternatives-and-their-requirements">
<section id="section-2.1.1">
          <h4 id="name-alternatives-and-their-requ">
<a href="#section-2.1.1" class="section-number selfRef">2.1.1. </a><a href="#name-alternatives-and-their-requ" class="section-name selfRef">Alternatives and Their Requirements</a>
          </h4>
<p id="section-2.1.1-1">Other protocols that can provide authentication could also be used for manifest delivery if defined later in another specification.
For example a protocol that asymmetrically signs each packet, as the one defined in Section 3 of <span>[<a href="#RFC6584" class="cite xref">RFC6584</a>]</span> does, would be a viable candidate for a delivery protocol for manifests that could be delivered over a multicast transport, which could have some important scalability benefits.<a href="#section-2.1.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1.1-2">Other methods of securely transmitting metadata equivalent to the metadata provided by the "ietf-ambi" YANG model could also be used to provide the same security guarantees with the manifest channels.
Defining other such possibilities is out of scope for this document.<a href="#section-2.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="system-security">
<section id="section-2.2">
        <h3 id="name-system-security">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-system-security" class="section-name selfRef">System Security</a>
        </h3>
<p id="section-2.2-1">By providing the means to authenticate multicast packets, AMBI aims to avoid giving attackers who can inject or modify packets the ability to attack application vulnerabilities that might be possible to exercise if those applications process the attack traffic.
Many of the entries in the Common Vulnerabilities and Exposures (CVE) list at <span>[<a href="#CVE" class="cite xref">CVE</a>]</span> (an extensive industry-wide database of software vulnerabilities) have documented a variety of system security problems that can result from maliciously generated UDP packets.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">TBD: Fold in a mention of how off-path attacks are possible from most places on the internet for interdomain multicast over AMT at an ingest point, and how the multicast fanout downstream of that can make it a good target if multicast sees more use.  A diagram plus a cleaned-up version of the on-list explanation here is probably appropriate: <a href="https://mailarchive.ietf.org/arch/msg/mboned/CG9FLjPwuno3MtvYvgNcD5p69I4/">https://mailarchive.ietf.org/arch/msg/mboned/CG9FLjPwuno3MtvYvgNcD5p69I4/</a>.  Nightmare scenario is zero-day RCE by off-path attacker that takes over a significant number of the devices watching a major sports event.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">See also work-in-progress: <a href="https://squarooticus.github.io/draft-krose-multicast-security/draft-krose-multicast-security.html">https://squarooticus.github.io/draft-krose-multicast-security/draft-krose-multicast-security.html</a><a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="protocol-operation">
<section id="section-3">
      <h2 id="name-protocol-operation">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-operation" class="section-name selfRef">Protocol Operation</a>
      </h2>
<div id="overview">
<section id="section-3.1">
        <h3 id="name-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-3.1-1">In order to authenticate a data packet, AMBI receivers need to hold these three pieces of information at the same time:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
            <p id="section-3.1-2.1.1">the data packet<a href="#section-3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.2">
            <p id="section-3.1-2.2.1">an authenticated manifest containing the packet digest for the data packet<a href="#section-3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.1-2.3">
            <p id="section-3.1-2.3.1">a digest profile defining the transformation from the data packet to its packet digest<a href="#section-3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.1-3">The manifests are delivered as a stream of manifests over an authenticated data channel.
Manifest contents MUST be authenticated before they can be used to authenticate data packets.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">The manifest stream is composed of an ordered sequence of manifests that each contain an ordered sequence of packet digests, corresponding to the original packets as sent from their origin, in the same order.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">Note that a manifest contains potentially many packet digests, and its size can be tuned to fit within a convenient PDU (Protocol Data Unit) of the manifest transport stream.
By doing so, many packet digests for the multicast data stream can be delivered per packet of the manifest transport.
The intent is that even with unicast-based manifest transport, multicast-style efficiencies of scale can still be realized with only a relatively small unicast overhead, when manifests use a unicast transport.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="buffering-of-packets-and-digests">
<section id="section-3.2">
        <h3 id="name-buffering-of-packets-and-di">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-buffering-of-packets-and-di" class="section-name selfRef">Buffering of Packets and Digests</a>
        </h3>
<p id="section-3.2-1">Using different communication channels for the manifest stream and the data stream introduces a possibility of desynchronization in the timing of the received data between the different channels, so receivers hold data packets and packet digests from the manifest stream in buffers for some duration while awaiting the arrival of their counterparts.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">While holding a data packet, if the corresponding packet digest for that packet arrives in the secured manifest stream, the data packet is authenticated.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">While holding an authenticated packet digest, if the corresponding data packet arrives with a matching packet digest, the data packet is authenticated.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Authenticating a data packet consumes one packet digest and prevents re-learning a digest for the same sequence number with a hold-down time equal to the hold time for packet digests.
The hold-down is necessary because a different manifest can send a duplicate packet digest for the same packet sequence number, either when repeating of packet digests is used for resilience to loss or when rotating authentication keys, so re-learning the packet digest could allow a replay of a data packet.
After authenticating a packet, the digest and any future digests for the same data packet remain consumed if it has been used to authenticate a data packet, ignoring repeated digests for the same sequence number until after the holddown timer expires.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">Once the data packet is authenticated it can be further processed by the receiving application or forwarded through the receiving network.<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">If the receiver's hold duration for a data packet expires without authenticating the packet, the packet SHOULD be dropped as unauthenticated.
If the hold duration of a manifest expires, packet digests last received in that manifest MUST be discarded.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">When multiple digests for the same packet sequence number are received, the latest received time for an authenticated packet digest should be used for the expiration time.<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<div id="validation-windows">
<section id="section-3.2.1">
          <h4 id="name-validation-windows">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-validation-windows" class="section-name selfRef">Validation Windows</a>
          </h4>
<p id="section-3.2.1-1">Since packet digests are usually smaller than the data packets, it's RECOMMENDED that senders generate and send manifests with timing such that the packet digests in a manifest will typically be received by subscribed receivers before the data packets corresponding to those digests are received.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">This strategy reduces the buffering requirements at receivers, at the cost of introducing some buffering of data packets at the sender, since data packets are generated before their packet digests can be added to manifests.<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3">The RECOMMENDED default hold times at receivers are:<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-4.1">
              <p id="section-3.2.1-4.1.1">2 seconds for data packets<a href="#section-3.2.1-4.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.1-4.2">
              <p id="section-3.2.1-4.2.1">10 seconds for packet digests<a href="#section-3.2.1-4.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.1-5">The sender MAY recommend different values for specific data streams, in order to tune different data streams for different performance goals.
The YANG model in <a href="#ref-yang" class="auto internal xref">Section 6</a> provides a mechanism for senders to communicate the sender's recommendation for buffering durations.
These parameters are "data-hold-time" and "digest-hold-time", expressed in milliseconds.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<p id="section-3.2.1-6">Receivers MAY deviate from the values recommended by the sender for a variety of reasons, including their own memory constraints or local administrative configuration (for example, it might improve user experience in some situations to hold packets longer than the server recommended when there are receiver-specific delays in the manifest stream that exceed the server's expectations).
Decreasing the buffering durations recommended by the server increases the risk of losing packets, but can be an appropriate tradeoff for specific network conditions and hardware or memory constraints on some devices.<a href="#section-3.2.1-6" class="pilcrow">¶</a></p>
<p id="section-3.2.1-7">Receivers SHOULD follow the recommendations for hold times provided by the sender (including the default values from the YANG model when unspecified), subject to their capabilities and any administratively configured overrides at the receiver.<a href="#section-3.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preserving-inter-packet-gap">
<section id="section-3.2.2">
          <h4 id="name-preserving-inter-packet-gap">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-preserving-inter-packet-gap" class="section-name selfRef">Preserving Inter-packet Gap</a>
          </h4>
<p id="section-3.2.2-1">It's RECOMMENDED that middle boxes forwarding buffered data packets preserve the inter-packet gap between packets in the same data stream, and that receiving libraries that perform AMBI-based authentication provide mechanisms to expose the network arrival times of packets to applications.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The purpose for this recommendation is to preserve the capability of receivers to use techniques for available bandwidth detection or network congestion based on observation of packet times and packet dispersal, making use of known patterns in the sending.
Examples of such techniques include those described in <span>[<a href="#PathChirp" class="cite xref">PathChirp</a>]</span>, <span>[<a href="#PathRate" class="cite xref">PathRate</a>]</span>, and <span>[<a href="#WEBRC" class="cite xref">WEBRC</a>]</span>.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">Note that this recommendation SHOULD NOT prevent the transmission of an authenticated packet because the prior packet is unauthenticated.
This recommendation only asks implementations to delay the transmission of an authenticated packet to correspond to the interpacket gap if an authenticated packet was previously transmitted and the authentication of the subsequent packet would otherwise burst the packets more quickly.<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">This does not prevent the transmission of packets out of order according to their order of authentication, only the timing of packets that are transmitted, after authentication, in the same order they were received.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">For receiver applications, the time that the original packet was received from the network SHOULD be made available to the receiving application.<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ref-digests">
<section id="section-3.3">
        <h3 id="name-packet-digests">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-packet-digests" class="section-name selfRef">Packet Digests</a>
        </h3>
<div id="ref-profile">
<section id="section-3.3.1">
          <h4 id="name-digest-profile">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-digest-profile" class="section-name selfRef">Digest Profile</a>
          </h4>
<p id="section-3.3.1-1">A packet digest is a message digest for a data packet, built according to a digest profile defined by the sender.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">The digest profile is defined by the sender, and specifies:<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3.1-3">
<li id="section-3.3.1-3.1">
              <p id="section-3.3.1-3.1.1">A cryptographically secure hash algorithm (REQUIRED)<a href="#section-3.3.1-3.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-3.2">
              <p id="section-3.3.1-3.2.1">A manifest stream identifier<a href="#section-3.3.1-3.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-3.3">
              <p id="section-3.3.1-3.3.1">Whether to hash the IP payload or the UDP payload. (see <a href="#payload-type" class="auto internal xref">Section 3.3.1.1</a>)<a href="#section-3.3.1-3.3.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.3.1-4">The hash algorithm is applied to a pseudoheader followed by the packet payload, as determined by the digest profile.
The computed hash value is the packet digest.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">TBD: As recommended by <a href="https://tools.ietf.org/html/rfc7696#section-2.2">https://tools.ietf.org/html/rfc7696#section-2.2</a>, a companion document containing the mandatory-to-implement cipher suite should also be published separately and referenced by this document.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
<div id="payload-type">
<section id="section-3.3.1.1">
            <h5 id="name-payload-type">
<a href="#section-3.3.1.1" class="section-number selfRef">3.3.1.1. </a><a href="#name-payload-type" class="section-name selfRef">Payload Type</a>
            </h5>
<div id="udp-vs-ip-payload-validation">
<section id="section-3.3.1.1.1">
              <h6 id="name-udp-vs-ip-payload-validatio">
<a href="#section-3.3.1.1.1" class="section-number selfRef">3.3.1.1.1. </a><a href="#name-udp-vs-ip-payload-validatio" class="section-name selfRef">UDP vs. IP payload validation</a>
              </h6>
<p id="section-3.3.1.1.1-1">When the manifest definition is at the UDP layer, it applies only to packets with IP protocol of UDP (0x11) and the payload used for calculating the packet digest includes only the UDP payload with length as the number of UDP payload octets, as calculated by subtracting the size of the UDP header from the UDP payload length.<a href="#section-3.3.1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1.1.1-2">When the manifest definition is at the IP layer, the payload used for calculating the packet digest includes the full IP payload of the data packets in the (S,G).
There is no restriction on the IP protocols that can be authenticated.
The length field in the pseudoheader is calculated by subtracting the IP Header Length from the IP length, and is equal to the number of octets in the payload for the digest calculation.<a href="#section-3.3.1.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="motivation">
<section id="section-3.3.1.1.2">
              <h6 id="name-motivation">
<a href="#section-3.3.1.1.2" class="section-number selfRef">3.3.1.1.2. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
              </h6>
<p id="section-3.3.1.1.2-1">Full IP payloads often aren't available to receivers without extra privileges on end user operating systems, so it's useful to provide a way to authenticate only the UDP payload, which is often the only portion of the packet available to many receiving applications.<a href="#section-3.3.1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1.1.2-2">However, for some use cases a full IP payload is appropriate.
For example, when retrofitting some existing protocols, some packets may be predictable or frequently repeated.
Use of an IPSec Authentication Header <span>[<a href="#RFC4302" class="cite xref">RFC4302</a>]</span> is one way to disambiguate such packets.
Even though the shared secret means the Authentication Header can't itself be used to authenticate the packet contents, the sequence number in the Authentication Header can ensure that specific packets are not repeated at the IP layer, and so it's useful for AMBI to have the capability to authenticate such packets.<a href="#section-3.3.1.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1.1.2-3">Another example: some services might need to authenticate the UDP options <span>[<a href="#I-D.ietf-tsvwg-udp-options" class="cite xref">I-D.ietf-tsvwg-udp-options</a>]</span>.
When using the UDP payload, the UDP options would not be part of the authenticated payload, but would be included when using the IP payload type.<a href="#section-3.3.1.1.2-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1.1.2-4">Lastly, since (S,G) subscription operates at the IP layer, it's possible that some non-UDP protocols will need to be authenticated, and the IP layer allows for this.
However, most user-space transport applications are expected to use the UDP layer authentication.<a href="#section-3.3.1.1.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="pseudoheader">
<section id="section-3.3.2">
          <h4 id="name-pseudoheader">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-pseudoheader" class="section-name selfRef">Pseudoheader</a>
          </h4>
<p id="section-3.3.2-1">When calculating the hash for the packet digest, the hash algorithm is applied to a pseudoheader followed by the payload from the packet.
The complete sequence of octets used to calculate the hash is structured as follows:<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.3.2-2">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Source Address (32 bits IPv4/128 bits IPv6)           |
|                             ...                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Destination Address (32 bits IPv4/128 bits IPv6)        |
|                             ...                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Zeroes    |   Protocol    |            Length             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Source Port          |        Destination Port       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Manifest Identifier                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Payload Data                           |
|                             ...                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.3.2-2" class="pilcrow">¶</a>
</div>
<div id="source-address">
<section id="section-3.3.2.1">
            <h5 id="name-source-address">
<a href="#section-3.3.2.1" class="section-number selfRef">3.3.2.1. </a><a href="#name-source-address" class="section-name selfRef">Source Address</a>
            </h5>
<p id="section-3.3.2.1-1">The IPv4 or IPv6 source address of the packet.<a href="#section-3.3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="destination-address">
<section id="section-3.3.2.2">
            <h5 id="name-destination-address">
<a href="#section-3.3.2.2" class="section-number selfRef">3.3.2.2. </a><a href="#name-destination-address" class="section-name selfRef">Destination Address</a>
            </h5>
<p id="section-3.3.2.2-1">The IPv4 or IPv6 destination address of the packet.<a href="#section-3.3.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="zeroes">
<section id="section-3.3.2.3">
            <h5 id="name-zeroes">
<a href="#section-3.3.2.3" class="section-number selfRef">3.3.2.3. </a><a href="#name-zeroes" class="section-name selfRef">Zeroes</a>
            </h5>
<p id="section-3.3.2.3-1">All bits set to 0.<a href="#section-3.3.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol">
<section id="section-3.3.2.4">
            <h5 id="name-protocol">
<a href="#section-3.3.2.4" class="section-number selfRef">3.3.2.4. </a><a href="#name-protocol" class="section-name selfRef">Protocol</a>
            </h5>
<p id="section-3.3.2.4-1">The IP Protocol field from IPv4, or the Next Header field for IPv6.
When using UDP-layer authentication, this value is always UDP (0x11) but for IP-layer authentication it can vary per-packet.<a href="#section-3.3.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="length">
<section id="section-3.3.2.5">
            <h5 id="name-length">
<a href="#section-3.3.2.5" class="section-number selfRef">3.3.2.5. </a><a href="#name-length" class="section-name selfRef">Length</a>
            </h5>
<p id="section-3.3.2.5-1">The length in octets of the Payload Data field, expressed as an unsigned 16-bit integer.<a href="#section-3.3.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="source-port">
<section id="section-3.3.2.6">
            <h5 id="name-source-port">
<a href="#section-3.3.2.6" class="section-number selfRef">3.3.2.6. </a><a href="#name-source-port" class="section-name selfRef">Source Port</a>
            </h5>
<p id="section-3.3.2.6-1">The source port of the packet.
Zeroes if using IP-layer authentication for a non-UDP protocol.<a href="#section-3.3.2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="destination-port">
<section id="section-3.3.2.7">
            <h5 id="name-destination-port">
<a href="#section-3.3.2.7" class="section-number selfRef">3.3.2.7. </a><a href="#name-destination-port" class="section-name selfRef">Destination Port</a>
            </h5>
<p id="section-3.3.2.7-1">The UDP destination port of the packet.
Zeroes if using IP-layer authentication for a non-UDP protocol.<a href="#section-3.3.2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manifest-identifier">
<section id="section-3.3.2.8">
            <h5 id="name-manifest-identifier">
<a href="#section-3.3.2.8" class="section-number selfRef">3.3.2.8. </a><a href="#name-manifest-identifier" class="section-name selfRef">Manifest Identifier</a>
            </h5>
<p id="section-3.3.2.8-1">The 32-bit identifier for the manifest stream.<a href="#section-3.3.2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="payload">
<section id="section-3.3.2.9">
            <h5 id="name-payload-data">
<a href="#section-3.3.2.9" class="section-number selfRef">3.3.2.9. </a><a href="#name-payload-data" class="section-name selfRef">Payload Data</a>
            </h5>
<p id="section-3.3.2.9-1">The payload data includes either the IP payload or the UDP payload, as indicated by the digest profile.<a href="#section-3.3.2.9-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ref-manifest">
<section id="section-3.4">
        <h3 id="name-manifests">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-manifests" class="section-name selfRef">Manifests</a>
        </h3>
<div id="manifest-layout">
<section id="section-3.4.1">
          <h4 id="name-manifest-layout">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-manifest-layout" class="section-name selfRef">Manifest Layout</a>
          </h4>
<div class="alignLeft art-text artwork" id="section-3.4.1-1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Manifest Stream Identifier                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Manifest sequence number                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 First packet sequence number                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|T|      Packet Digest Count    | TLV Space (present iff T set) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       ... TLVs (Length=TLV Space or 0 if T unset) ...         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ... Packet Digests ...                   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3.4.1-1" class="pilcrow">¶</a>
</div>
<div id="manifest-stream-identifier">
<section id="section-3.4.1.1">
            <h5 id="name-manifest-stream-identifier">
<a href="#section-3.4.1.1" class="section-number selfRef">3.4.1.1. </a><a href="#name-manifest-stream-identifier" class="section-name selfRef">Manifest Stream Identifier</a>
            </h5>
<p id="section-3.4.1.1-1">A 32-bit unsigned integer chosen by the sender.
This value MUST be equal to the "id" field in the manifest-stream in the "ietf-ambi" model.
If a manifest is seen that does not have the expected value from the metadata provided for the manifest, the receiver MUST stop processing this manifest and disconnect from this manifest stream.
It MAY reconnect with an exponential backoff starting at 1s, or it MAY connect to an alternative manifest stream if one is known.<a href="#section-3.4.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="manifest-sequence-number">
<section id="section-3.4.1.2">
            <h5 id="name-manifest-sequence-number">
<a href="#section-3.4.1.2" class="section-number selfRef">3.4.1.2. </a><a href="#name-manifest-sequence-number" class="section-name selfRef">Manifest Sequence Number</a>
            </h5>
<p id="section-3.4.1.2-1">A monotonically increasing 32-bit unsigned integer.
Each manifest sent by the sender increases this value by 1.
On overflow it wraps to 0.<a href="#section-3.4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1.2-2">It's RECOMMENDED to expire the manifest stream and start a new stream for the data packets before a sequence number wrap is necessary.<a href="#section-3.4.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="first-packet-sequence-number">
<section id="section-3.4.1.3">
            <h5 id="name-first-packet-sequence-numbe">
<a href="#section-3.4.1.3" class="section-number selfRef">3.4.1.3. </a><a href="#name-first-packet-sequence-numbe" class="section-name selfRef">First Packet Sequence Number</a>
            </h5>
<p id="section-3.4.1.3-1">A monotonically increasing 32-bit unsigned integer.
Each packet in the data stream increases this value by 1.<a href="#section-3.4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1.3-2">It's RECOMMENDED to expire the manifest stream and start a new stream for the data packets before a sequence number wrap is necessary.<a href="#section-3.4.1.3-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1.3-3">Note: for redundancy, especially if using a manifest stream with unreliable transport, successive manifests MAY provide duplicates of the same packet digest with the same packet sequence number, using overapping sets of packet sequence numbers.
When received, these reset the hold timer for the listed packet digests.<a href="#section-3.4.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="t-bit-tlvs-present">
<section id="section-3.4.1.4">
            <h5 id="name-t-bit-tlvs-present">
<a href="#section-3.4.1.4" class="section-number selfRef">3.4.1.4. </a><a href="#name-t-bit-tlvs-present" class="section-name selfRef">T bit (TLVs Present)</a>
            </h5>
<p id="section-3.4.1.4-1">If 1, this indicates the TLV Length and TLV space fields are present.
If 0, this indicates neither field is present.<a href="#section-3.4.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packet-digest-count">
<section id="section-3.4.1.5">
            <h5 id="name-packet-digest-count">
<a href="#section-3.4.1.5" class="section-number selfRef">3.4.1.5. </a><a href="#name-packet-digest-count" class="section-name selfRef">Packet Digest Count</a>
            </h5>
<p id="section-3.4.1.5-1">A 15-bit unsigned integer equal to the count of packet digests in the manifest.<a href="#section-3.4.1.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tlv-space">
<section id="section-3.4.1.6">
            <h5 id="name-tlv-space">
<a href="#section-3.4.1.6" class="section-number selfRef">3.4.1.6. </a><a href="#name-tlv-space" class="section-name selfRef">TLV Space</a>
            </h5>
<p id="section-3.4.1.6-1">A 16-bit unsigned integer with the length of the TLVs section.<a href="#section-3.4.1.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tlvs">
<section id="section-3.4.1.7">
            <h5 id="name-tlvs">
<a href="#section-3.4.1.7" class="section-number selfRef">3.4.1.7. </a><a href="#name-tlvs" class="section-name selfRef">TLVs</a>
            </h5>
<p id="section-3.4.1.7-1">These are Type-Length-Value blocks, back to back.
These may be extended by future specifications.<a href="#section-3.4.1.7-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1.7-2">These are composed of 3 fields:<a href="#section-3.4.1.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4.1.7-3.1">
                <p id="section-3.4.1.7-3.1.1">Type: an 8-bit unsigned integer indicating the type.  Type values in 0-127 have an 8-bit length, and type values in 128-255 have a 16-bit length.<a href="#section-3.4.1.7-3.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.1.7-3.2">
                <p id="section-3.4.1.7-3.2.1">Length: a 8-bit or 16-bit unsigned integer indicating the length of the value<a href="#section-3.4.1.7-3.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-3.4.1.7-3.3">
                <p id="section-3.4.1.7-3.3.1">Value: a value with semantics defined by the Type field.<a href="#section-3.4.1.7-3.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
<p id="section-3.4.1.7-4">Defined values:<a href="#section-3.4.1.7-4" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
              <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Name</th>
                  <th class="text-left" rowspan="1" colspan="1">Value</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Pad</td>
                  <td class="text-left" rowspan="1" colspan="1">Length can be 0-255. Value is filled with 0 and ignored by receiver.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">128</td>
                  <td class="text-left" rowspan="1" colspan="1">Refresh Deadline</td>
                  <td class="text-left" rowspan="1" colspan="1">Length MUST be 2.  Value is a 16-bit unsigned integer number of seconds.  When this field is absent or zero, it means the current digest profile for the current manifest stream is stable.  A nonzero value means the authentication is transitioning to a new manifest stream, and the set of digest profiles SHOULD be refreshed by receivers before this much time has elapsed in order to avoid a disruption.  See <a href="#transition" class="auto internal xref">Section 3.5</a>.</td>
                </tr>
              </tbody>
            </table>
<p id="section-3.4.1.7-6">1-120 and 129-248 are unassigned
121-127 and 249-255 are reserved for experiments<a href="#section-3.4.1.7-6" class="pilcrow">¶</a></p>
<p id="section-3.4.1.7-7">Any unknown values MUST be skipped and ignored by the receiver, using the Length field to skip.<a href="#section-3.4.1.7-7" class="pilcrow">¶</a></p>
<p id="section-3.4.1.7-8">The total size of the manifest in octets is exactly equal to:<a href="#section-3.4.1.7-8" class="pilcrow">¶</a></p>
<p id="section-3.4.1.7-9">Size of digests * packet count + 14 if T is 0
 Size of digests * packet count + 16 + TLV Length if T is 1<a href="#section-3.4.1.7-9" class="pilcrow">¶</a></p>
<p id="section-3.4.1.7-10">The total size of the TLV space is exactly equal to:<a href="#section-3.4.1.7-10" class="pilcrow">¶</a></p>
<p id="section-3.4.1.7-11">(2 + Length) summed for each TLV<a href="#section-3.4.1.7-11" class="pilcrow">¶</a></p>
<p id="section-3.4.1.7-12">The total size of the TLV space MUST exactly equal TLV Length.
If the TLV space exceeds the TLV Length, the receiver MUST disconnect, and behave as if the Manifest Stream Identifier was wrong.
This state indicates a failed decoding of the TLV space.<a href="#section-3.4.1.7-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packet-digests">
<section id="section-3.4.1.8">
            <h5 id="name-packet-digests-2">
<a href="#section-3.4.1.8" class="section-number selfRef">3.4.1.8. </a><a href="#name-packet-digests-2" class="section-name selfRef">Packet Digests</a>
            </h5>
<p id="section-3.4.1.8-1">Packet digests appended one after the other, aligned to 8-bit boundaries with 0-bit padding at the end if the bit length of the digests are not multiples of 8 bits.<a href="#section-3.4.1.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="transition">
<section id="section-3.5">
        <h3 id="name-transitioning-to-other-mani">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-transitioning-to-other-mani" class="section-name selfRef">Transitioning to Other Manifest Streams</a>
        </h3>
<p id="section-3.5-1">It's possible for multiple manifest streams authenticating the same data stream to be active at the same time.
The different manifest streams can have different hash algorithms, manifest ids, and current packet sequence numbers for the same data stream.
These result in different sets of packet digests for the same data packets, one digest per packet per digest profile.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">It's necessary sometimes to transition gracefully from one manifest stream to another.
The Refresh Deadline TLV from the manifest is used to signal to receivers the need to transition.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">When a receiver gets a nonzero refresh deadline in a manifest the sender SHOULD have an alternate manifest stream ready and available, and the receiver SHOULD learn the alternate manifest stream, join the new one, and leave the old one before the number of seconds given in the refresh deadline.
After the refresh deadline has expired, a manifest stream MAY stop transmitting and close connections from the server side.
When multiple manifest-streams are provided in the metadata, all or all but one SHOULD contain an expire-time, and new or refreshing receivers SHOULD choose a manifest stream without an expire-time, or with the latest expire-time if all manifests have an expire-time.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">The receivers SHOULD start the refresh after a random time delay between now and one half the number of seconds in the deadline field after the first manifest they receive containing a nonzero refresh deadline.
This time delay is to desynchronize the refresh attempts in order to spread the spike of load on the DORMS server while changing manifest profiles during a large multicast event.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ref-transport">
<section id="section-4">
      <h2 id="name-transport-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-transport-considerations" class="section-name selfRef">Transport Considerations</a>
      </h2>
<div id="overview-1">
<section id="section-4.1">
        <h3 id="name-overview-2">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-overview-2" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-4.1-1">AMBI manifests MUST be authenticated, but any transport protocol providing authentication can be used.
This section discusses several viable options for the use of an authenticating transport, and some associated design considerations.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">TBD: add ALTA to the list when and if it gets further along <span>[<a href="#I-D.draft-krose-mboned-alta" class="cite xref">I-D.draft-krose-mboned-alta</a>]</span>.
Sending an authenticatable multicast stream (instead of the below unicast-based proposals) is a worthwhile goal, else a 1% unicast authentication overhead becomes a new unicast limit to the scalability.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">TBD: probably should add quic also?  Or maybe https is sufficient?<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">TBD: add a recommendation about scalability, like with DORMS, when using a unicast hash stream.
CDN or other kind of fanout solution that can scale the delivery, and still generally hit the time window.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="https">
<section id="section-4.2">
        <h3 id="name-https">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-https" class="section-name selfRef">HTTPS</a>
        </h3>
<p id="section-4.2-1">This document defines a new media type 'application/ambi' for use with HTTPS.  URIs in the manifest-transport list with the scheme 'https' use this transport.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">An HTTPS stream carrying the 'application/ambi' media type is composed of a sequence of binary AMBI manifests, sent back to back in the payload body (payload body is defined in Section 3.3 of <span>[<a href="#RFC7230" class="cite xref">RFC7230</a>]</span>).<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">Complete packet digests from partially received manifests MAY be used by the receiver for authentication of data packets from the multicast channel, even if the full manifest is not yet delivered.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="tls">
<section id="section-4.3">
        <h3 id="name-tls">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-tls" class="section-name selfRef">TLS</a>
        </h3>
<p id="section-4.3-1">This document defines the new uri scheme 'ambi+tls' for use with TLS <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.  URIs in the manifest-transport list with the scheme 'ambi+tls' use this transport.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">A TLS stream carrying AMBI manifests is composed of a sequence of binary AMBI manifests, transmitted back to back.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">Complete packet Digests from partially received manifests MAY be used by the receiver for authentication, even if the full manifest is not yet delivered.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls">
<section id="section-4.4">
        <h3 id="name-dtls">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-dtls" class="section-name selfRef">DTLS</a>
        </h3>
<p id="section-4.4-1">This document defines the new uri scheme 'ambi+dtls' for use with DTLS <span>[<a href="#RFC6347" class="cite xref">RFC6347</a>]</span>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">Manifests transported with DTLS have the tradeoff (relative to TLS or HTTPS) that they might be lost and not retransmitted or reordered, but they will not cause head-of-line blocking or delay in processing data packets that arrived later.
For some applications this is a worthwhile tradeoff.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<p id="section-4.4-3">Note that loss of a single DTLS packet can result in the loss of multiple packet digests, which can mean failure to authenticate multiple data packets.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<p id="section-4.4-4">DTLS transport for manifests supports one manifest per packet.
It's OPTIONAL to provides for some redundancy in packet digests by providing overlap in the packet sequence numbers across different manifests, thereby sending some or all packet digests multiple times to avoid loss.<a href="#section-4.4-4" class="pilcrow">¶</a></p>
<p id="section-4.4-5">Future extensions might define extensions that can provide more efficient redundancy via FEC.
Those future extensions will require a different URI scheme.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="examples">
<section id="section-5">
      <h2 id="name-examples">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-examples" class="section-name selfRef">Examples</a>
      </h2>
<p id="section-5-1">TBD: walk through some examples as soon as we have a build running.
Likely to need some touching up of the spec along the way...<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ref-yang">
<section id="section-6">
      <h2 id="name-yang-module">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-yang-module" class="section-name selfRef">YANG Module</a>
      </h2>
<div id="tree-diagram">
<section id="section-6.1">
        <h3 id="name-tree-diagram">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-tree-diagram" class="section-name selfRef">Tree Diagram</a>
        </h3>
<p id="section-6.1-1">The tree diagram below follows the notation defined in <span>[<a href="#RFC8340" class="cite xref">RFC8340</a>]</span>.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-2">
<pre>
YANG-TREE ietf-ambi.yang
</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="module">
<section id="section-6.2">
        <h3 id="name-module">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-module" class="section-name selfRef">Module</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-6.2-1">
<pre>
YANG-MODULE ietf-ambi.yang
</pre><a href="#section-6.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="the-yang-module-names-registry">
<section id="section-7.1">
        <h3 id="name-the-yang-module-names-regis">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-the-yang-module-names-regis" class="section-name selfRef">The YANG Module Names Registry</a>
        </h3>
<p id="section-7.1-1">This document adds one YANG module to the "YANG Module Names" registry maintained at &lt;https://www.iana.org/assignments/yang-parameters&gt;.
The following registrations are made, per the format in Section 14 of <span>[<a href="#RFC6020" class="cite xref">RFC6020</a>]</span>:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.1-2">
<pre>
      name:      ietf-ambi
      namespace: urn:ietf:params:xml:ns:yang:ietf-ambi
      prefix:    ambi
      reference: I-D.draft-jholland-mboned-ambi
</pre><a href="#section-7.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="the-xml-registry">
<section id="section-7.2">
        <h3 id="name-the-xml-registry">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-the-xml-registry" class="section-name selfRef">The XML Registry</a>
        </h3>
<p id="section-7.2-1">This document adds the following registration to the "ns" subregistry of the "IETF XML Registry" defined in <span>[<a href="#RFC3688" class="cite xref">RFC3688</a>]</span>, referencing this document.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-7.2-2">
<pre>
       URI: urn:ietf:params:xml:ns:yang:ietf-ambi
       Registrant Contact: The IESG.
       XML: N/A, the requested URI is an XML namespace.
</pre><a href="#section-7.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="media-type">
<section id="section-7.3">
        <h3 id="name-media-type">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-media-type" class="section-name selfRef">Media Type</a>
        </h3>
<p id="section-7.3-1">TBD: Register 'application/ambi' according to advice from: <a href="https://www.iana.org/form/media-types">https://www.iana.org/form/media-types</a><a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">TBD: check guidelines in <a href="https://tools.ietf.org/html/rfc8126">https://tools.ietf.org/html/rfc8126</a><a href="#section-7.3-2" class="pilcrow">¶</a></p>
<p id="section-7.3-3">TBD: comments from Amanda: The first is that the current IANA Considerations RFC is RFC 8126 rather than 5226. The other point, which you may be aware of, is that while https://www.iana.org/form/media-types provides guidance, standards-tree registrations submitted through RFCs shouldn't be submitted through that form and (unlike vendor-tree subtypes and standards-tree subtypes documented in other standards organization specs) won't need to be explicitly approved by the IESG-designated experts. Instead, the advice in RFC 6838 is that media type registrations requested by IETF-stream I-Ds be informally reviewed on the media-types@iana.org mailing list, which the IESG-designated experts participate in.<a href="#section-7.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="uri-schemes">
<section id="section-7.4">
        <h3 id="name-uri-schemes">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-uri-schemes" class="section-name selfRef">URI Schemes</a>
        </h3>
<div id="tls-1">
<section id="section-7.4.1">
          <h4 id="name-tls-2">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-tls-2" class="section-name selfRef">TLS</a>
          </h4>
<p id="section-7.4.1-1">TBD: register 'ambi+tls' as a uri scheme according to advice from: <a href="https://datatracker.ietf.org/doc/html/rfc7595">https://datatracker.ietf.org/doc/html/rfc7595</a><a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dtls-1">
<section id="section-7.4.2">
          <h4 id="name-dtls-2">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-dtls-2" class="section-name selfRef">DTLS</a>
          </h4>
<p id="section-7.4.2-1">TBD: register 'ambi+dtls' as a uri scheme according to advice from: <a href="https://datatracker.ietf.org/doc/html/rfc7595">https://datatracker.ietf.org/doc/html/rfc7595</a><a href="#section-7.4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="ref-security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="predictable-packets">
<section id="section-8.1">
        <h3 id="name-predictable-packets">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-predictable-packets" class="section-name selfRef">Predictable Packets</a>
        </h3>
<p id="section-8.1-1">Protocols that have predictable packets run the risk of offline attacks for hash collisions against those packets.
When authenticating a protocol that might have predictable packets, it's RECOMMENDED to use a hash function secure against such attacks or to add content to the packets to make them unpredictable, such as an Authentication Header (<span>[<a href="#RFC4302" class="cite xref">RFC4302</a>]</span>), or the addition of an ignored field with random content to the packet payload.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">TBD: explain attack from generating malicious packets and then looking for collisions, as opposed to having to generate a collision on packet contents that include a sequence number and then hitting a match.<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<p id="section-8.1-3">TBD: follow the rest of the guidelines: https://tools.ietf.org/html/rfc3552<a href="#section-8.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attacks-on-side-applications">
<section id="section-8.2">
        <h3 id="name-attacks-on-side-application">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-attacks-on-side-application" class="section-name selfRef">Attacks on Side Applications</a>
        </h3>
<p id="section-8.2-1">A multicast receiver subscribes to an (S,G) and if it's a UDP application, listens on a socket with a port number for packets to arrive.<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<p id="section-8.2-2">UDP applications sometimes bind to an "unspecified" address ("::" or "0.0.0.0") for a particular UDP port, which will make the appliction receive and process any packet that arrives on said port.<a href="#section-8.2-2" class="pilcrow">¶</a></p>
<p id="section-8.2-3">Forwarding multicast traffic opens a new practical attack surface against receivers that have bound sockets using the "unspecified" address and were operating behind a firewall and/or NAT.
Such applications will receive traffic from the internet only after sending an outbound packet, and usually only for return packets with the reversed source and destination port and IP addresses.<a href="#section-8.2-3" class="pilcrow">¶</a></p>
<p id="section-8.2-4">Multicast subscription and routing operates at the IP layer, so when a multicst receive application subscribes to a channel, traffic with the IP addresses for that channel will start arriving.
There is no selection for the UDP port at the routing layer that prevents multicast IP traffic from arriving.<a href="#section-8.2-4" class="pilcrow">¶</a></p>
<p id="section-8.2-5">When an insecure application with a vulnerability is listening to a UDP port on an unspecified address, it will receive multicast packets arriving at the device and with that destination UDP port.
Although the primary problem lies in the insecure application, accepting multicast subscriptions increases the attack scope against those applications to include attackers who can inject a packet into a properly subscribed multicast stream.<a href="#section-8.2-5" class="pilcrow">¶</a></p>
<p id="section-8.2-6">It's RECOMMENDED that senders using AMBI to secure their traffic include all IP traffic that they send in their DORMS metadata information, and that firewalls using AMBI to provide secure access to multicast traffic block multicast traffic destined to unsecured UDP ports on (S,G)s that have AMBI-based security for any traffic.
This mitigation prevents new forwarding of multicast traffic from providing attackers with a packet inject capability access to new attack surfaces from pre-existing insecure apps.<a href="#section-8.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">Many thanks to Daniel Franke, Eric Rescorla, Christian Worm Mortensen, Max Franke, Albert Manfredi, and Amanda Baber for their very helpful comments and suggestions.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.draft-ietf-mboned-dorms">[I-D.draft-ietf-mboned-dorms]</dt>
        <dd>
<span class="refAuthor">Holland, J.</span>, <span class="refTitle">"Discovery Of Restconf Metadata for Source-specific multicast"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-mboned-dorms-04</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-mboned-dorms-04">https://datatracker.ietf.org/doc/html/draft-ietf-mboned-dorms-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6347">https://www.rfc-editor.org/rfc/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7230">https://www.rfc-editor.org/rfc/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7950">https://www.rfc-editor.org/rfc/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8340">[RFC8340]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M.</span> and <span class="refAuthor">L. Berger, Ed.</span>, <span class="refTitle">"YANG Tree Diagrams"</span>, <span class="seriesInfo">BCP 215</span>, <span class="seriesInfo">RFC 8340</span>, <span class="seriesInfo">DOI 10.17487/RFC8340</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8340">https://www.rfc-editor.org/rfc/rfc8340</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="CVE">[CVE]</dt>
        <dd>
<span class="refAuthor">MITRE</span>, <span class="refTitle">"Common Vulnerabilities and Exposures"</span>, <time datetime="1999-09" class="refDate">September 1999</time>, <span>&lt;<a href="https://cve.mitre.org/">https://cve.mitre.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.draft-krose-mboned-alta">[I-D.draft-krose-mboned-alta]</dt>
        <dd>
<span class="refAuthor">Rose, K.</span> and <span class="refAuthor">J. Holland</span>, <span class="refTitle">"Asymmetric Loss-Tolerant Authentication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-krose-mboned-alta-01</span>, <time datetime="2019-07-08" class="refDate">8 July 2019</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-krose-mboned-alta-01">https://datatracker.ietf.org/doc/html/draft-krose-mboned-alta-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tsvwg-udp-options">[I-D.ietf-tsvwg-udp-options]</dt>
        <dd>
<span class="refAuthor">Touch, J. D.</span> and <span class="refAuthor">C. M. Heard</span>, <span class="refTitle">"Transport Options for UDP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tsvwg-udp-options-38</span>, <time datetime="2024-11-03" class="refDate">3 November 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tsvwg-udp-options-38">https://datatracker.ietf.org/doc/html/draft-ietf-tsvwg-udp-options-38</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PathChirp">[PathChirp]</dt>
        <dd>
<span class="refAuthor">Ribeiro, V. J.</span>, <span class="refAuthor">Riedi, R. H.</span>, <span class="refAuthor">Baraniuk, R. G.</span>, <span class="refAuthor">Navratil, J.</span>, <span class="refAuthor">Cottrell, L.</span>, <span class="refAuthor">Department of Electrical and Computer Engineering Rice University</span>, and <span class="refAuthor">SLAC/SCS-Network Monitoring, Stanford University</span>, <span class="refTitle">"pathChirp: Efficient Available Bandwidth Estimation for Network Paths"</span>, <time datetime="2003" class="refDate">2003</time>. </dd>
<dd class="break"></dd>
<dt id="PathRate">[PathRate]</dt>
        <dd>
<span class="refAuthor">Dovrolis, C.</span>, <span class="refAuthor">Ramanathan, P.</span>, and <span class="refAuthor">D. Moore</span>, <span class="refTitle">"Packet dispersion techniques and a capacity estimation methodology"</span>, <span class="seriesInfo">IEEE/ACM Transactions on Networking, Volume 12, Issue 6, pp. 963-977. </span>, <time datetime="2004-12" class="refDate">December 2004</time>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3552">https://www.rfc-editor.org/rfc/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3688">[RFC3688]</dt>
        <dd>
<span class="refAuthor">Mealling, M.</span>, <span class="refTitle">"The IETF XML Registry"</span>, <span class="seriesInfo">BCP 81</span>, <span class="seriesInfo">RFC 3688</span>, <span class="seriesInfo">DOI 10.17487/RFC3688</span>, <time datetime="2004-01" class="refDate">January 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc3688">https://www.rfc-editor.org/rfc/rfc3688</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4082">[RFC4082]</dt>
        <dd>
<span class="refAuthor">Perrig, A.</span>, <span class="refAuthor">Song, D.</span>, <span class="refAuthor">Canetti, R.</span>, <span class="refAuthor">Tygar, J. D.</span>, and <span class="refAuthor">B. Briscoe</span>, <span class="refTitle">"Timed Efficient Stream Loss-Tolerant Authentication (TESLA): Multicast Source Authentication Transform Introduction"</span>, <span class="seriesInfo">RFC 4082</span>, <span class="seriesInfo">DOI 10.17487/RFC4082</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4082">https://www.rfc-editor.org/rfc/rfc4082</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4302">[RFC4302]</dt>
        <dd>
<span class="refAuthor">Kent, S.</span>, <span class="refTitle">"IP Authentication Header"</span>, <span class="seriesInfo">RFC 4302</span>, <span class="seriesInfo">DOI 10.17487/RFC4302</span>, <time datetime="2005-12" class="refDate">December 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4302">https://www.rfc-editor.org/rfc/rfc4302</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4383">[RFC4383]</dt>
        <dd>
<span class="refAuthor">Baugher, M.</span> and <span class="refAuthor">E. Carrara</span>, <span class="refTitle">"The Use of Timed Efficient Stream Loss-Tolerant Authentication (TESLA) in the Secure Real-time Transport Protocol (SRTP)"</span>, <span class="seriesInfo">RFC 4383</span>, <span class="seriesInfo">DOI 10.17487/RFC4383</span>, <time datetime="2006-02" class="refDate">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4383">https://www.rfc-editor.org/rfc/rfc4383</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5776">[RFC5776]</dt>
        <dd>
<span class="refAuthor">Roca, V.</span>, <span class="refAuthor">Francillon, A.</span>, and <span class="refAuthor">S. Faurite</span>, <span class="refTitle">"Use of Timed Efficient Stream Loss-Tolerant Authentication (TESLA) in the Asynchronous Layered Coding (ALC) and NACK-Oriented Reliable Multicast (NORM) Protocols"</span>, <span class="seriesInfo">RFC 5776</span>, <span class="seriesInfo">DOI 10.17487/RFC5776</span>, <time datetime="2010-04" class="refDate">April 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5776">https://www.rfc-editor.org/rfc/rfc5776</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
        <dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time datetime="2010-10" class="refDate">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6020">https://www.rfc-editor.org/rfc/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6584">[RFC6584]</dt>
        <dd>
<span class="refAuthor">Roca, V.</span>, <span class="refTitle">"Simple Authentication Schemes for the Asynchronous Layered Coding (ALC) and NACK-Oriented Reliable Multicast (NORM) Protocols"</span>, <span class="seriesInfo">RFC 6584</span>, <span class="seriesInfo">DOI 10.17487/RFC6584</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6584">https://www.rfc-editor.org/rfc/rfc6584</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="WEBRC">[WEBRC]</dt>
      <dd>
<span class="refAuthor">Luby, M.</span> and <span class="refAuthor">V. Goyal</span>, <span class="refTitle">"Wave and Equation Based Rate Control Using Multicast Round Trip Time: Extended Report"</span>, <span class="seriesInfo">Digital Fountain Technical Report no. DF2002-07-001 </span>, <time datetime="2002-09" class="refDate">September 2002</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jake Holland</span></div>
<div dir="auto" class="left"><span class="org">Akamai Technologies, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">150 Broadway</span></div>
<div dir="auto" class="left">
<span class="locality">Cambridge, MA 02144</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jakeholland.net@gmail.com" class="email">jakeholland.net@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kyle Rose</span></div>
<div dir="auto" class="left"><span class="org">Akamai Technologies, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">150 Broadway</span></div>
<div dir="auto" class="left">
<span class="locality">Cambridge, MA 02144</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:krose@krose.org" class="email">krose@krose.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
